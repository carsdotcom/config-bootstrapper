{"version":3,"sources":["config-bootstrapper.min.js"],"names":["f","exports","module","define","amd","window","global","self","this","ConfigBootstrapper","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","1","Object","defineProperty","value","_typeof","Symbol","iterator","obj","constructor","prototype","options","cbs","refreshRate","refreshRateMs","dataStorageKey","timestampStorageKey","timeout","isReady","timeoutCounter","readyPollRate","_loadData","setTimeout","refreshHandler","default","markAsReady","ready","callback","getData","data","JSON","parse","localStorage","getItem","ts","now","xhr","parseInt","Date","XMLHttpRequest","open","url","onreadystatechange","readyState","status","setItem","responseText","send"],"mappings":"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","file":"config-bootstrapper.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.ConfigBootstrapper = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.default = ConfigBootstrapper;\n/*!\n * Config Bootstrapper v0.1.1 <https://github.com/carsdotcom/config-bootstrapper>\n * @license Apache 2.0\n * @copyright 2015 Cars.com <http://www.cars.com/>\n * @author Mac Heller-Ogden <mheller-ogden@cars.com>\n * @summary A simple configuration bootstrapper\n */\nfunction ConfigBootstrapper(options) {\n    var cbs = this;\n\n    options = (typeof options === 'undefined' ? 'undefined' : _typeof(options)) == \"object\" ? options : {};\n    options.refreshRate = options.refreshRate || 300;\n    options.refreshRateMs = options.refreshRate * 1000;\n    options.dataStorageKey = options.dataStorageKey || 'configBootstrapper.data';\n    options.timestampStorageKey = options.timestampStorageKey || 'configBootstrapper.timestamp';\n    options.timeout = options.timeout || 4000;\n\n    cbs.options = options;\n\n    cbs.isReady = false;\n    cbs.timeoutCounter = 0;\n    cbs.readyPollRate = 50;\n\n    cbs._loadData();\n\n    setTimeout(function refreshHandler() {\n        cbs._loadData();\n        setTimeout(refreshHandler, options.refreshRateMs);\n    }, options.refreshRateMs);\n}\n\nConfigBootstrapper.prototype.markAsReady = function () {\n    this.isReady = true;\n};\n\nConfigBootstrapper.prototype.ready = function (callback) {\n    var cbs = this;\n    if (cbs.isReady) {\n        callback(cbs.getData());\n    } else if (cbs.timeoutCounter <= cbs.options.timeout) {\n        cbs.timeoutCounter = cbs.timeoutCounter + cbs.readyPollRate;\n        setTimeout(function () {\n            cbs.ready(callback);\n        }, cbs.readyPollRate);\n    } else {\n        callback(cbs.getData());\n    }\n};\n\nConfigBootstrapper.prototype.getData = function () {\n    var data = {};\n    try {\n        data = JSON.parse(localStorage.getItem(this.options.dataStorageKey)) || {};\n    } catch (e) {}\n    return data;\n};\n\nConfigBootstrapper.prototype._loadData = function () {\n    var cbs, ts, now, xhr;\n\n    cbs = this;\n\n    ts = parseInt(localStorage.getItem(cbs.options.timestampStorageKey), 10);\n    now = Date.now();\n\n    if (!ts || now >= ts + cbs.options.refreshRateMs) {\n        xhr = new XMLHttpRequest();\n        xhr.open('GET', cbs.options.url, true);\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == 4) {\n                // `DONE`\n                if (xhr.status == 200) {\n                    localStorage.setItem(cbs.options.dataStorageKey, xhr.responseText);\n                    localStorage.setItem(cbs.options.timestampStorageKey, now);\n                }\n                cbs.markAsReady();\n            }\n        };\n        xhr.send();\n    } else {\n        cbs.markAsReady();\n    }\n};\n\n},{}]},{},[1])(1)\n});\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvY29uZmlnLWJvb3RzdHJhcHBlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7O2tCQ093QixrQjtBQVB4Qjs7Ozs7OztBQU9lLFNBQVMsa0JBQVQsQ0FBNEIsT0FBNUIsRUFBcUM7QUFDaEQsUUFBSSxNQUFNLElBQVY7O0FBRUEsY0FBVyxRQUFPLE9BQVAseUNBQU8sT0FBUCxNQUFrQixRQUFuQixHQUErQixPQUEvQixHQUF5QyxFQUFuRDtBQUNBLFlBQVEsV0FBUixHQUFzQixRQUFRLFdBQVIsSUFBdUIsR0FBN0M7QUFDQSxZQUFRLGFBQVIsR0FBd0IsUUFBUSxXQUFSLEdBQXNCLElBQTlDO0FBQ0EsWUFBUSxjQUFSLEdBQXlCLFFBQVEsY0FBUixJQUEwQix5QkFBbkQ7QUFDQSxZQUFRLG1CQUFSLEdBQThCLFFBQVEsbUJBQVIsSUFBK0IsOEJBQTdEO0FBQ0EsWUFBUSxPQUFSLEdBQWtCLFFBQVEsT0FBUixJQUFtQixJQUFyQzs7QUFFQSxRQUFJLE9BQUosR0FBYyxPQUFkOztBQUVBLFFBQUksT0FBSixHQUFjLEtBQWQ7QUFDQSxRQUFJLGNBQUosR0FBcUIsQ0FBckI7QUFDQSxRQUFJLGFBQUosR0FBb0IsRUFBcEI7O0FBRUEsUUFBSSxTQUFKOztBQUVBLGVBQVcsU0FBUyxjQUFULEdBQTBCO0FBQ2pDLFlBQUksU0FBSjtBQUNBLG1CQUFXLGNBQVgsRUFBMkIsUUFBUSxhQUFuQztBQUNILEtBSEQsRUFHRyxRQUFRLGFBSFg7QUFJSDs7QUFFRCxtQkFBbUIsU0FBbkIsQ0FBNkIsV0FBN0IsR0FBMkMsWUFBWTtBQUNuRCxTQUFLLE9BQUwsR0FBZSxJQUFmO0FBQ0gsQ0FGRDs7QUFJQSxtQkFBbUIsU0FBbkIsQ0FBNkIsS0FBN0IsR0FBcUMsVUFBVSxRQUFWLEVBQW9CO0FBQ3JELFFBQUksTUFBTSxJQUFWO0FBQ0EsUUFBSSxJQUFJLE9BQVIsRUFBaUI7QUFDYixpQkFBUyxJQUFJLE9BQUosRUFBVDtBQUNILEtBRkQsTUFFTyxJQUFJLElBQUksY0FBSixJQUFzQixJQUFJLE9BQUosQ0FBWSxPQUF0QyxFQUErQztBQUNsRCxZQUFJLGNBQUosR0FBcUIsSUFBSSxjQUFKLEdBQXFCLElBQUksYUFBOUM7QUFDQSxtQkFBVyxZQUFZO0FBQ25CLGdCQUFJLEtBQUosQ0FBVSxRQUFWO0FBQ0gsU0FGRCxFQUVHLElBQUksYUFGUDtBQUdILEtBTE0sTUFLQTtBQUNILGlCQUFTLElBQUksT0FBSixFQUFUO0FBQ0g7QUFDSixDQVpEOztBQWNBLG1CQUFtQixTQUFuQixDQUE2QixPQUE3QixHQUF1QyxZQUFZO0FBQy9DLFFBQUksT0FBTyxFQUFYO0FBQ0EsUUFBSTtBQUNBLGVBQU8sS0FBSyxLQUFMLENBQVcsYUFBYSxPQUFiLENBQXFCLEtBQUssT0FBTCxDQUFhLGNBQWxDLENBQVgsS0FBaUUsRUFBeEU7QUFDSCxLQUZELENBRUUsT0FBTyxDQUFQLEVBQVUsQ0FBRTtBQUNkLFdBQU8sSUFBUDtBQUNILENBTkQ7O0FBUUEsbUJBQW1CLFNBQW5CLENBQTZCLFNBQTdCLEdBQXlDLFlBQVk7QUFDakQsUUFBSSxHQUFKLEVBQ0ksRUFESixFQUVJLEdBRkosRUFHSSxHQUhKOztBQUtBLFVBQU0sSUFBTjs7QUFFQSxTQUFLLFNBQVMsYUFBYSxPQUFiLENBQXFCLElBQUksT0FBSixDQUFZLG1CQUFqQyxDQUFULEVBQWdFLEVBQWhFLENBQUw7QUFDQSxVQUFNLEtBQUssR0FBTCxFQUFOOztBQUVBLFFBQUksQ0FBQyxFQUFELElBQVEsT0FBUSxLQUFLLElBQUksT0FBSixDQUFZLGFBQXJDLEVBQXNEO0FBQ2xELGNBQU0sSUFBSSxjQUFKLEVBQU47QUFDQSxZQUFJLElBQUosQ0FBUyxLQUFULEVBQWdCLElBQUksT0FBSixDQUFZLEdBQTVCLEVBQWlDLElBQWpDO0FBQ0EsWUFBSSxrQkFBSixHQUF5QixZQUFZO0FBQ2pDLGdCQUFJLElBQUksVUFBSixJQUFrQixDQUF0QixFQUF5QjtBQUFFO0FBQ3ZCLG9CQUFJLElBQUksTUFBSixJQUFjLEdBQWxCLEVBQXVCO0FBQ25CLGlDQUFhLE9BQWIsQ0FBcUIsSUFBSSxPQUFKLENBQVksY0FBakMsRUFBaUQsSUFBSSxZQUFyRDtBQUNBLGlDQUFhLE9BQWIsQ0FBcUIsSUFBSSxPQUFKLENBQVksbUJBQWpDLEVBQXNELEdBQXREO0FBQ0g7QUFDRCxvQkFBSSxXQUFKO0FBQ0g7QUFDSixTQVJEO0FBU0EsWUFBSSxJQUFKO0FBQ0gsS0FiRCxNQWFPO0FBQ0gsWUFBSSxXQUFKO0FBQ0g7QUFDSixDQTNCRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qIVxuICogQ29uZmlnIEJvb3RzdHJhcHBlciB2MC4xLjEgPGh0dHBzOi8vZ2l0aHViLmNvbS9jYXJzZG90Y29tL2NvbmZpZy1ib290c3RyYXBwZXI+XG4gKiBAbGljZW5zZSBBcGFjaGUgMi4wXG4gKiBAY29weXJpZ2h0IDIwMTUgQ2Fycy5jb20gPGh0dHA6Ly93d3cuY2Fycy5jb20vPlxuICogQGF1dGhvciBNYWMgSGVsbGVyLU9nZGVuIDxtaGVsbGVyLW9nZGVuQGNhcnMuY29tPlxuICogQHN1bW1hcnkgQSBzaW1wbGUgY29uZmlndXJhdGlvbiBib290c3RyYXBwZXJcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29uZmlnQm9vdHN0cmFwcGVyKG9wdGlvbnMpIHtcbiAgICB2YXIgY2JzID0gdGhpcztcblxuICAgIG9wdGlvbnMgPSAodHlwZW9mIG9wdGlvbnMgPT0gXCJvYmplY3RcIikgPyBvcHRpb25zIDoge307XG4gICAgb3B0aW9ucy5yZWZyZXNoUmF0ZSA9IG9wdGlvbnMucmVmcmVzaFJhdGUgfHwgMzAwO1xuICAgIG9wdGlvbnMucmVmcmVzaFJhdGVNcyA9IG9wdGlvbnMucmVmcmVzaFJhdGUgKiAxMDAwO1xuICAgIG9wdGlvbnMuZGF0YVN0b3JhZ2VLZXkgPSBvcHRpb25zLmRhdGFTdG9yYWdlS2V5IHx8ICdjb25maWdCb290c3RyYXBwZXIuZGF0YSc7XG4gICAgb3B0aW9ucy50aW1lc3RhbXBTdG9yYWdlS2V5ID0gb3B0aW9ucy50aW1lc3RhbXBTdG9yYWdlS2V5IHx8ICdjb25maWdCb290c3RyYXBwZXIudGltZXN0YW1wJztcbiAgICBvcHRpb25zLnRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQgfHwgNDAwMDtcblxuICAgIGNicy5vcHRpb25zID0gb3B0aW9ucztcblxuICAgIGNicy5pc1JlYWR5ID0gZmFsc2U7XG4gICAgY2JzLnRpbWVvdXRDb3VudGVyID0gMDtcbiAgICBjYnMucmVhZHlQb2xsUmF0ZSA9IDUwO1xuXG4gICAgY2JzLl9sb2FkRGF0YSgpO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiByZWZyZXNoSGFuZGxlcigpIHtcbiAgICAgICAgY2JzLl9sb2FkRGF0YSgpO1xuICAgICAgICBzZXRUaW1lb3V0KHJlZnJlc2hIYW5kbGVyLCBvcHRpb25zLnJlZnJlc2hSYXRlTXMpO1xuICAgIH0sIG9wdGlvbnMucmVmcmVzaFJhdGVNcyk7XG59XG5cbkNvbmZpZ0Jvb3RzdHJhcHBlci5wcm90b3R5cGUubWFya0FzUmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5pc1JlYWR5ID0gdHJ1ZTtcbn07XG5cbkNvbmZpZ0Jvb3RzdHJhcHBlci5wcm90b3R5cGUucmVhZHkgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICB2YXIgY2JzID0gdGhpcztcbiAgICBpZiAoY2JzLmlzUmVhZHkpIHtcbiAgICAgICAgY2FsbGJhY2soY2JzLmdldERhdGEoKSk7XG4gICAgfSBlbHNlIGlmIChjYnMudGltZW91dENvdW50ZXIgPD0gY2JzLm9wdGlvbnMudGltZW91dCkge1xuICAgICAgICBjYnMudGltZW91dENvdW50ZXIgPSBjYnMudGltZW91dENvdW50ZXIgKyBjYnMucmVhZHlQb2xsUmF0ZTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjYnMucmVhZHkoY2FsbGJhY2spO1xuICAgICAgICB9LCBjYnMucmVhZHlQb2xsUmF0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2soY2JzLmdldERhdGEoKSk7XG4gICAgfVxufTtcblxuQ29uZmlnQm9vdHN0cmFwcGVyLnByb3RvdHlwZS5nZXREYXRhID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBkYXRhID0ge307XG4gICAgdHJ5IHtcbiAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5vcHRpb25zLmRhdGFTdG9yYWdlS2V5KSkgfHwge307XG4gICAgfSBjYXRjaCAoZSkge31cbiAgICByZXR1cm4gZGF0YTtcbn07XG5cbkNvbmZpZ0Jvb3RzdHJhcHBlci5wcm90b3R5cGUuX2xvYWREYXRhID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjYnMsXG4gICAgICAgIHRzLFxuICAgICAgICBub3csXG4gICAgICAgIHhocjtcblxuICAgIGNicyA9IHRoaXM7XG5cbiAgICB0cyA9IHBhcnNlSW50KGxvY2FsU3RvcmFnZS5nZXRJdGVtKGNicy5vcHRpb25zLnRpbWVzdGFtcFN0b3JhZ2VLZXkpLCAxMCk7XG4gICAgbm93ID0gRGF0ZS5ub3coKTtcblxuICAgIGlmICghdHMgfHwgKG5vdyA+PSAodHMgKyBjYnMub3B0aW9ucy5yZWZyZXNoUmF0ZU1zKSkpIHtcbiAgICAgICAgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHhoci5vcGVuKCdHRVQnLCBjYnMub3B0aW9ucy51cmwsIHRydWUpO1xuICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09IDQpIHsgLy8gYERPTkVgXG4gICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGNicy5vcHRpb25zLmRhdGFTdG9yYWdlS2V5LCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY2JzLm9wdGlvbnMudGltZXN0YW1wU3RvcmFnZUtleSwgbm93KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2JzLm1hcmtBc1JlYWR5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHhoci5zZW5kKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2JzLm1hcmtBc1JlYWR5KCk7XG4gICAgfVxufTtcbiJdfQ==\n"]}